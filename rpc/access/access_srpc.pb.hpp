//go:build deps_only && cgo

// Code generated by protoc-gen-starpc-cpp. DO NOT EDIT.
// protoc-gen-starpc-cpp version: v0.46.1
// source: github.com/aperturerobotics/bifrost/rpc/access/access.proto

#pragma once

#include <functional>
#include <memory>
#include <string>
#include <utility>

#include "srpc/starpc.hpp"

#include "access.pb.h"

namespace bifrost::rpc::access {

// Service ID for AccessRpcService
constexpr const char* kSRPCAccessRpcServiceServiceID = "bifrost.rpc.access.AccessRpcService";

class SRPCAccessRpcService_LookupRpcServiceClient;
class SRPCAccessRpcService_LookupRpcServiceStream;
class SRPCAccessRpcService_CallRpcServiceClient;
class SRPCAccessRpcService_CallRpcServiceStream;

// SRPCAccessRpcServiceClient is the client API for AccessRpcService service.
class SRPCAccessRpcServiceClient {
 public:
  virtual ~SRPCAccessRpcServiceClient() = default;

  // SRPCClient returns the underlying SRPC client.
  virtual starpc::Client* SRPCClient() = 0;

  // LookupRpcService
  virtual std::pair<std::unique_ptr<SRPCAccessRpcService_LookupRpcServiceClient>, starpc::Error> LookupRpcService(const bifrost::rpc::access::LookupRpcServiceRequest& in) = 0;
  // CallRpcService
  virtual std::pair<std::unique_ptr<SRPCAccessRpcService_CallRpcServiceClient>, starpc::Error> CallRpcService() = 0;
};

// SRPCAccessRpcServiceClientImpl implements SRPCAccessRpcServiceClient.
class SRPCAccessRpcServiceClientImpl : public SRPCAccessRpcServiceClient {
 public:
  explicit SRPCAccessRpcServiceClientImpl(starpc::Client* cc, const std::string& service_id = "")
      : cc_(cc), service_id_(service_id.empty() ? kSRPCAccessRpcServiceServiceID : service_id) {}

  starpc::Client* SRPCClient() override { return cc_; }

  // LookupRpcService
  virtual std::pair<std::unique_ptr<SRPCAccessRpcService_LookupRpcServiceClient>, starpc::Error> LookupRpcService(const bifrost::rpc::access::LookupRpcServiceRequest& in) override;
  // CallRpcService
  virtual std::pair<std::unique_ptr<SRPCAccessRpcService_CallRpcServiceClient>, starpc::Error> CallRpcService() override;

 private:
  starpc::Client* cc_;
  std::string service_id_;
};

// NewSRPCAccessRpcServiceClient creates a new client.
inline std::unique_ptr<SRPCAccessRpcServiceClient> NewSRPCAccessRpcServiceClient(starpc::Client* cc) {
  return std::make_unique<SRPCAccessRpcServiceClientImpl>(cc);
}

// SRPCAccessRpcServiceServer is the server API for AccessRpcService service.
class SRPCAccessRpcServiceServer {
 public:
  virtual ~SRPCAccessRpcServiceServer() = default;

  // LookupRpcService
  virtual starpc::Error LookupRpcService(const bifrost::rpc::access::LookupRpcServiceRequest& req, SRPCAccessRpcService_LookupRpcServiceStream* strm) = 0;
  // CallRpcService
  virtual starpc::Error CallRpcService(SRPCAccessRpcService_CallRpcServiceStream* strm) = 0;
};

// SRPCAccessRpcServiceHandler implements starpc::Handler for AccessRpcService.
class SRPCAccessRpcServiceHandler : public starpc::Handler {
 public:
  SRPCAccessRpcServiceHandler(SRPCAccessRpcServiceServer* impl, const std::string& service_id = "")
      : impl_(impl), service_id_(service_id.empty() ? kSRPCAccessRpcServiceServiceID : service_id) {}

  const std::string& GetServiceID() const override { return service_id_; }
  std::vector<std::string> GetMethodIDs() const override;
  std::pair<bool, starpc::Error> InvokeMethod(
      const std::string& service_id,
      const std::string& method_id,
      starpc::Stream* strm) override;

 private:
  SRPCAccessRpcServiceServer* impl_;
  std::string service_id_;
};

// NewSRPCAccessRpcServiceHandler creates a new handler for the given implementation.
inline std::unique_ptr<SRPCAccessRpcServiceHandler> NewSRPCAccessRpcServiceHandler(SRPCAccessRpcServiceServer* impl) {
  return std::make_unique<SRPCAccessRpcServiceHandler>(impl);
}

// SRPCRegisterAccessRpcService registers the server implementation with the mux.
// The returned handler must outlive the mux registration.
inline std::pair<std::unique_ptr<SRPCAccessRpcServiceHandler>, starpc::Error> SRPCRegisterAccessRpcService(starpc::Mux* mux, SRPCAccessRpcServiceServer* impl) {
  auto handler = NewSRPCAccessRpcServiceHandler(impl);
  starpc::Error err = mux->Register(handler.get());
  if (err != starpc::Error::OK) {
    return {nullptr, err};
  }
  return {std::move(handler), starpc::Error::OK};
}

// SRPCAccessRpcService_LookupRpcServiceClient is the client stream for LookupRpcService.
class SRPCAccessRpcService_LookupRpcServiceClient {
 public:
  explicit SRPCAccessRpcService_LookupRpcServiceClient(std::unique_ptr<starpc::Stream> strm) : strm_(std::move(strm)) {}

  starpc::Error Recv(bifrost::rpc::access::LookupRpcServiceResponse* msg) {
    return strm_->MsgRecv(msg);
  }

  starpc::Error CloseSend() { return strm_->CloseSend(); }
  starpc::Error Close() { return strm_->Close(); }

 private:
  std::unique_ptr<starpc::Stream> strm_;
};

// SRPCAccessRpcService_LookupRpcServiceStream is the server stream for LookupRpcService.
class SRPCAccessRpcService_LookupRpcServiceStream {
 public:
  explicit SRPCAccessRpcService_LookupRpcServiceStream(starpc::Stream* strm) : strm_(strm) {}

  starpc::Error Send(const bifrost::rpc::access::LookupRpcServiceResponse& msg) {
    return strm_->MsgSend(msg);
  }

  starpc::Error SendAndClose(const bifrost::rpc::access::LookupRpcServiceResponse& msg) {
    starpc::Error err = strm_->MsgSend(msg);
    if (err != starpc::Error::OK) return err;
    return strm_->CloseSend();
  }

 private:
  starpc::Stream* strm_;
};

// SRPCAccessRpcService_CallRpcServiceClient is the client stream for CallRpcService.
class SRPCAccessRpcService_CallRpcServiceClient {
 public:
  explicit SRPCAccessRpcService_CallRpcServiceClient(std::unique_ptr<starpc::Stream> strm) : strm_(std::move(strm)) {}

  starpc::Error Send(const rpcstream::RpcStreamPacket& msg) {
    return strm_->MsgSend(msg);
  }

  starpc::Error Recv(rpcstream::RpcStreamPacket* msg) {
    return strm_->MsgRecv(msg);
  }

  starpc::Error CloseSend() { return strm_->CloseSend(); }
  starpc::Error Close() { return strm_->Close(); }

 private:
  std::unique_ptr<starpc::Stream> strm_;
};

// SRPCAccessRpcService_CallRpcServiceStream is the server stream for CallRpcService.
class SRPCAccessRpcService_CallRpcServiceStream {
 public:
  explicit SRPCAccessRpcService_CallRpcServiceStream(starpc::Stream* strm) : strm_(strm) {}

  starpc::Error Send(const rpcstream::RpcStreamPacket& msg) {
    return strm_->MsgSend(msg);
  }

  starpc::Error SendAndClose(const rpcstream::RpcStreamPacket& msg) {
    starpc::Error err = strm_->MsgSend(msg);
    if (err != starpc::Error::OK) return err;
    return strm_->CloseSend();
  }

  starpc::Error Recv(rpcstream::RpcStreamPacket* msg) {
    return strm_->MsgRecv(msg);
  }

 private:
  starpc::Stream* strm_;
};

}  // namespace bifrost::rpc::access
