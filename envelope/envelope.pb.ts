// @generated by protoc-gen-es-lite unknown with parameter "target=ts,ts_nocheck=false"
// @generated from file github.com/aperturerobotics/bifrost/envelope/envelope.proto (package envelope, syntax proto3)
/* eslint-disable */

import type { MessageType, PartialFieldInfo } from '@aptre/protobuf-es-lite'
import { createMessageType, ScalarType } from '@aptre/protobuf-es-lite'

export const protobufPackage = 'envelope'

/**
 * EnvelopeGrant is an encrypted bundle of shares.
 * The grant ciphertext contains a marshaled EnvelopeGrantInner.
 * Encrypted to one or more keypairs in the Envelope keypairs list.
 *
 * @generated from message envelope.EnvelopeGrant
 */
export interface EnvelopeGrant {
  /**
   * KeypairIndexes lists which keypairs can decrypt this grant.
   * Each value is an index into the Envelope.keypairs list.
   *
   * @generated from field: repeated uint32 keypair_indexes = 1;
   */
  keypairIndexes?: number[]
  /**
   * Ciphertexts contains the encrypted EnvelopeGrantInner.
   * One ciphertext per keypair index, in the same order.
   * Each encrypted with peer.EncryptToPubKey to the corresponding keypair.
   *
   * @generated from field: repeated bytes ciphertexts = 2;
   */
  ciphertexts?: Uint8Array[]
}

// EnvelopeGrant contains the message type declaration for EnvelopeGrant.
export const EnvelopeGrant: MessageType<EnvelopeGrant> = createMessageType({
  typeName: 'envelope.EnvelopeGrant',
  fields: [
    {
      no: 1,
      name: 'keypair_indexes',
      kind: 'scalar',
      T: ScalarType.UINT32,
      repeated: true,
    },
    {
      no: 2,
      name: 'ciphertexts',
      kind: 'scalar',
      T: ScalarType.BYTES,
      repeated: true,
    },
  ] as readonly PartialFieldInfo[],
  packedByDefault: true,
})

/**
 * EnvelopeKeypair is a public key entry in the envelope.
 *
 * @generated from message envelope.EnvelopeKeypair
 */
export interface EnvelopeKeypair {
  /**
   * PubKey is the marshaled public key in PEM format (via bifrost/keypem).
   *
   * @generated from field: bytes pub_key = 1;
   */
  pubKey?: Uint8Array
  /**
   * AuthMethodId is an optional identifier for the auth method.
   * Application-specific hint for how to derive the private key.
   *
   * @generated from field: string auth_method_id = 2;
   */
  authMethodId?: string
  /**
   * AuthMethodParams is optional parameters for the auth method.
   *
   * @generated from field: bytes auth_method_params = 3;
   */
  authMethodParams?: Uint8Array
}

// EnvelopeKeypair contains the message type declaration for EnvelopeKeypair.
export const EnvelopeKeypair: MessageType<EnvelopeKeypair> = createMessageType({
  typeName: 'envelope.EnvelopeKeypair',
  fields: [
    { no: 1, name: 'pub_key', kind: 'scalar', T: ScalarType.BYTES },
    { no: 2, name: 'auth_method_id', kind: 'scalar', T: ScalarType.STRING },
    { no: 3, name: 'auth_method_params', kind: 'scalar', T: ScalarType.BYTES },
  ] as readonly PartialFieldInfo[],
  packedByDefault: true,
})

/**
 * Envelope contains an encrypted message unlockable via secret sharing.
 *
 * The message is encrypted with a key derived from a Ristretto255 scalar.
 * The scalar is split into shares distributed across Grants.
 * At least threshold+1 shares are needed to reconstruct the scalar.
 *
 * @generated from message envelope.Envelope
 */
export interface Envelope {
  /**
   * EnvelopeId is the unique identifier of the envelope.
   * If empty when building, generated from hash of secret + context.
   *
   * @generated from field: string envelope_id = 1;
   */
  envelopeId?: string
  /**
   * ContextHash is the BLAKE3 hash of the context string.
   * Used to verify the envelope matches the expected application context.
   *
   * @generated from field: bytes context_hash = 2;
   */
  contextHash?: Uint8Array
  /**
   * Threshold is the CIRCL threshold parameter.
   * Recovery requires threshold+1 shares.
   * If zero, any single share suffices (no secret splitting).
   *
   * @generated from field: uint32 threshold = 3;
   */
  threshold?: number
  /**
   * Ciphertext is the encrypted payload.
   * Encrypted with XChaCha20-Poly1305 using a key derived from the scalar.
   *
   * @generated from field: bytes ciphertext = 4;
   */
  ciphertext?: Uint8Array
  /**
   * Grants is the list of encrypted share bundles.
   *
   * @generated from field: repeated envelope.EnvelopeGrant grants = 5;
   */
  grants?: EnvelopeGrant[]
  /**
   * Keypairs is the list of public keys used to encrypt grants.
   *
   * @generated from field: repeated envelope.EnvelopeKeypair keypairs = 6;
   */
  keypairs?: EnvelopeKeypair[]
  /**
   * Contents is an optional plaintext description of what the envelope contains.
   * Application-specific; not used in the unlock process.
   *
   * @generated from field: bytes contents = 7;
   */
  contents?: Uint8Array
}

// Envelope contains the message type declaration for Envelope.
export const Envelope: MessageType<Envelope> = createMessageType({
  typeName: 'envelope.Envelope',
  fields: [
    { no: 1, name: 'envelope_id', kind: 'scalar', T: ScalarType.STRING },
    { no: 2, name: 'context_hash', kind: 'scalar', T: ScalarType.BYTES },
    { no: 3, name: 'threshold', kind: 'scalar', T: ScalarType.UINT32 },
    { no: 4, name: 'ciphertext', kind: 'scalar', T: ScalarType.BYTES },
    {
      no: 5,
      name: 'grants',
      kind: 'message',
      T: () => EnvelopeGrant,
      repeated: true,
    },
    {
      no: 6,
      name: 'keypairs',
      kind: 'message',
      T: () => EnvelopeKeypair,
      repeated: true,
    },
    { no: 7, name: 'contents', kind: 'scalar', T: ScalarType.BYTES },
  ] as readonly PartialFieldInfo[],
  packedByDefault: true,
})

/**
 * EnvelopeShare is a single Shamir share (Ristretto255 scalar pair).
 *
 * @generated from message envelope.EnvelopeShare
 */
export interface EnvelopeShare {
  /**
   * Id is the share identifier (marshaled Ristretto255 scalar, 32 bytes).
   *
   * @generated from field: bytes id = 1;
   */
  id?: Uint8Array
  /**
   * Value is the share value (marshaled Ristretto255 scalar, 32 bytes).
   *
   * @generated from field: bytes value = 2;
   */
  value?: Uint8Array
}

// EnvelopeShare contains the message type declaration for EnvelopeShare.
export const EnvelopeShare: MessageType<EnvelopeShare> = createMessageType({
  typeName: 'envelope.EnvelopeShare',
  fields: [
    { no: 1, name: 'id', kind: 'scalar', T: ScalarType.BYTES },
    { no: 2, name: 'value', kind: 'scalar', T: ScalarType.BYTES },
  ] as readonly PartialFieldInfo[],
  packedByDefault: true,
})

/**
 * EnvelopeGrantInner is the decrypted contents of a grant.
 *
 * @generated from message envelope.EnvelopeGrantInner
 */
export interface EnvelopeGrantInner {
  /**
   * Shares is the list of Shamir shares in this grant.
   *
   * @generated from field: repeated envelope.EnvelopeShare shares = 1;
   */
  shares?: EnvelopeShare[]
}

// EnvelopeGrantInner contains the message type declaration for EnvelopeGrantInner.
export const EnvelopeGrantInner: MessageType<EnvelopeGrantInner> =
  createMessageType({
    typeName: 'envelope.EnvelopeGrantInner',
    fields: [
      {
        no: 1,
        name: 'shares',
        kind: 'message',
        T: () => EnvelopeShare,
        repeated: true,
      },
    ] as readonly PartialFieldInfo[],
    packedByDefault: true,
  })

/**
 * EnvelopeGrantConfig configures a single grant in the envelope.
 *
 * @generated from message envelope.EnvelopeGrantConfig
 */
export interface EnvelopeGrantConfig {
  /**
   * ShareCount is the number of shares to include in this grant.
   * If zero, defaults to 1.
   *
   * @generated from field: uint32 share_count = 1;
   */
  shareCount?: number
  /**
   * KeypairIndexes lists which keypairs can decrypt this grant.
   * Indexes into the keypairs list provided to BuildEnvelope.
   *
   * @generated from field: repeated uint32 keypair_indexes = 2;
   */
  keypairIndexes?: number[]
}

// EnvelopeGrantConfig contains the message type declaration for EnvelopeGrantConfig.
export const EnvelopeGrantConfig: MessageType<EnvelopeGrantConfig> =
  createMessageType({
    typeName: 'envelope.EnvelopeGrantConfig',
    fields: [
      { no: 1, name: 'share_count', kind: 'scalar', T: ScalarType.UINT32 },
      {
        no: 2,
        name: 'keypair_indexes',
        kind: 'scalar',
        T: ScalarType.UINT32,
        repeated: true,
      },
    ] as readonly PartialFieldInfo[],
    packedByDefault: true,
  })

/**
 * EnvelopeConfig is the configuration for building an envelope.
 *
 * @generated from message envelope.EnvelopeConfig
 */
export interface EnvelopeConfig {
  /**
   * EnvelopeId is the unique identifier. If empty, auto-generated.
   *
   * @generated from field: string envelope_id = 1;
   */
  envelopeId?: string
  /**
   * Threshold is the CIRCL threshold parameter (need threshold+1 shares).
   * If zero, any single share suffices.
   *
   * @generated from field: uint32 threshold = 2;
   */
  threshold?: number
  /**
   * TotalShares is the total number of shares to create.
   * If zero, defaults to sum of shares across all grant configs.
   *
   * @generated from field: uint32 total_shares = 3;
   */
  totalShares?: number
  /**
   * GrantConfigs defines how shares are distributed across grants.
   *
   * @generated from field: repeated envelope.EnvelopeGrantConfig grant_configs = 4;
   */
  grantConfigs?: EnvelopeGrantConfig[]
}

// EnvelopeConfig contains the message type declaration for EnvelopeConfig.
export const EnvelopeConfig: MessageType<EnvelopeConfig> = createMessageType({
  typeName: 'envelope.EnvelopeConfig',
  fields: [
    { no: 1, name: 'envelope_id', kind: 'scalar', T: ScalarType.STRING },
    { no: 2, name: 'threshold', kind: 'scalar', T: ScalarType.UINT32 },
    { no: 3, name: 'total_shares', kind: 'scalar', T: ScalarType.UINT32 },
    {
      no: 4,
      name: 'grant_configs',
      kind: 'message',
      T: () => EnvelopeGrantConfig,
      repeated: true,
    },
  ] as readonly PartialFieldInfo[],
  packedByDefault: true,
})

/**
 * EnvelopeUnlockResult is the result of attempting to unlock an envelope.
 *
 * @generated from message envelope.EnvelopeUnlockResult
 */
export interface EnvelopeUnlockResult {
  /**
   * Success indicates whether the envelope was fully unlocked.
   *
   * @generated from field: bool success = 1;
   */
  success?: boolean
  /**
   * SharesAvailable is the number of shares recovered from grants.
   *
   * @generated from field: uint32 shares_available = 2;
   */
  sharesAvailable?: number
  /**
   * SharesNeeded is the number of shares needed (threshold+1).
   *
   * @generated from field: uint32 shares_needed = 3;
   */
  sharesNeeded?: number
  /**
   * UnlockedGrantIndexes lists which grants were successfully decrypted.
   *
   * @generated from field: repeated uint32 unlocked_grant_indexes = 4;
   */
  unlockedGrantIndexes?: number[]
}

// EnvelopeUnlockResult contains the message type declaration for EnvelopeUnlockResult.
export const EnvelopeUnlockResult: MessageType<EnvelopeUnlockResult> =
  createMessageType({
    typeName: 'envelope.EnvelopeUnlockResult',
    fields: [
      { no: 1, name: 'success', kind: 'scalar', T: ScalarType.BOOL },
      { no: 2, name: 'shares_available', kind: 'scalar', T: ScalarType.UINT32 },
      { no: 3, name: 'shares_needed', kind: 'scalar', T: ScalarType.UINT32 },
      {
        no: 4,
        name: 'unlocked_grant_indexes',
        kind: 'scalar',
        T: ScalarType.UINT32,
        repeated: true,
      },
    ] as readonly PartialFieldInfo[],
    packedByDefault: true,
  })
